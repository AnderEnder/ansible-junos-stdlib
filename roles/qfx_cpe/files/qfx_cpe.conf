version 12.1R1.9;
groups {
    qfabric {
        chassis {
            aggregated-devices {
                ethernet {
                    device-count 3;
                }
            }
            fpc 0 {
                pic 1 {
                    sfpplus {
                        pic-mode 1g;
                    }
                }
            }
            alarm {
                management-ethernet {
                    link-down ignore;
                }
            }
            lcd-menu {
                fpc 0 {
                    menu-item {
                        maintenance-menu disable;
                    }
                }
            }
        }
        protocols {
            rstp {
                interface ae2.0 {
                    mode point-to-point;
                }
                interface all {
                    edge;
                    no-root-port;
                }
                bpdu-block-on-edge;
            }
            lldp {
                interface all;
            }
        }
        class-of-service {
            classifiers {
                ieee-802.1 onep_qfabric_classifier {
                    forwarding-class class_3 {
                        loss-priority low code-points [ 110 111 ];
                    }
                    forwarding-class class_2 {
                        loss-priority low code-points 100;
                        loss-priority high code-points 101;
                    }
                    forwarding-class class_0 {
                        loss-priority low code-points 010;
                        loss-priority high code-points 001;
                    }
                }
                inet-precedence IP_qfabric_classifier {
                    forwarding-class class_3 {
                        loss-priority low code-points [ 110 111 ];
                    }
                    forwarding-class class_2 {
                        loss-priority low code-points 100;
                        loss-priority high code-points 101;
                    }
                    forwarding-class class_0 {
                        loss-priority low code-points 010;
                        loss-priority high code-points 001;
                    }
                }
            }
            forwarding-classes {
                class class_3 queue-num 7;
                class class_2 queue-num 2;
                class class_0 queue-num 0;
            }
            interfaces {
                ge-*/0/* {
                    scheduler-map cpe_network_smap;
                    unit 0 {
                        classifiers {
                            ieee-802.1 onep_qfabric_classifier;
                            inet-precedence IP_qfabric_classifier;
                        }
                    }
                }
                ae* {
                    scheduler-map cpe_network_smap;
                    unit 0 {
                        classifiers {
                            ieee-802.1 onep_qfabric_classifier;
                            inet-precedence IP_qfabric_classifier;
                        }
                    }
                }
            }
            scheduler-maps {
                cpe_network_smap {
                    forwarding-class class_3 scheduler scheduler_3;
                    forwarding-class class_2 scheduler scheduler_2;
                    forwarding-class class_0 scheduler scheduler_0;
                }
            }
            schedulers {
                scheduler_3 {
                    buffer-size percent 30;
                    priority strict-high;
                }
                scheduler_2 {
                    transmit-rate percent 75;
                    buffer-size percent 30;
                    priority low;
                }
                scheduler_0 {
                    transmit-rate percent 25;
                    buffer-size percent 40;
                    priority low;
                }
            }
        }
        ethernet-switching-options {
            storm-control {
                interface all {
                    bandwidth 10000;
                }
            }
        }
        vlans {
            qfabric {
                vlan-id 100;
                dot1q-tunneling;
            }
        }
    }
    qfabric-int {
        interfaces {
            <*> {
                mtu 9216;
                unit 0 {
                    family ethernet-switching {
                        port-mode access;
                        vlan {
                            members qfabric;
                        }
                    }
                }
            }
        }
    }
    qfabric-ae {
        interfaces {
            <*> {
                aggregated-ether-options {
                    link-speed 1g;
                    lacp {
                        active;
                    }
                }
            }
        }
    }
}
apply-groups qfabric;
interfaces {
    interface-range Node_Device_Interfaces {
        member "ge-0/0/[0-15]";
        apply-groups qfabric-int;
        description "QFabric Node Device";
    }
    interface-range Interconnect_Device_Interfaces {
        member "ge-0/0/[16-19]";
        apply-groups qfabric-int;
        description "QFabric Interconnect Device";
    }
    interface-range Director_Device_DG0_LAG_Interfaces {
        member "ge-0/0/[20-21]";
        description "QFabric Director Device - DG0";
        ether-options {
            speed {
                1g;
            }
            802.3ad ae0;
        }
    }
    interface-range Director_Device_DG1_LAG_Interfaces {
        member "ge-0/0/[22-23]";
        description "QFabric Director Device - DG1";
        ether-options {
            speed {
                1g;
            }
            802.3ad ae1;
        }
    }
    interface-range Control_Plane_Inter_LAG_Interfaces {
        member ge-0/1/0;
        member ge-0/1/1;
        description "QFabric Control Plane (Inter - Switch LAG)";
        ether-options {
            802.3ad ae2;
        }
    }
    ae0 {
        apply-groups [ qfabric-int qfabric-ae ];
        description "QFabric Director Device - DG0";
    }
    ae1 {
        apply-groups [ qfabric-int qfabric-ae ];
        description "QFabric Director Device - DG1";
    }
    ae2 {
        description "QFabric Control Plane (Inter-Switch LAG)";
        mtu 9216;
        aggregated-ether-options {
            link-speed 1g;
            lacp {
                active;
            }
        }
        unit 0 {
            family ethernet-switching {
                vlan {
                    members qfabric;
                }
            }
        }
    }
}
